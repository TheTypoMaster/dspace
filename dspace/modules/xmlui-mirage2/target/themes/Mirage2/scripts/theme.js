function DSpaceSetupAutocomplete(a,b){$(function(){null==b.authorityName&&(b.authorityName=dspace_makeFieldInput(b.inputName,"_authority"));var c=$("#"+a)[0],d=c.elements[b.inputName].id,e=null;null!=c.elements[b.authorityName]&&(e=c.elements[b.authorityName].id);var f=b.contextPath+"/choices/"+b.metadataField,g=null==b.collection?-1:b.collection;f+="?collection="+g;var h=$("#"+d);h.autocomplete({source:function(a,b){var c=f;a&&a.term&&(c+="&query="+a.term),$.get(c,function(a){var c=[],d=[];$(a).find("Choice").each(function(){var a=$(this).attr("value")?$(this).attr("value"):null,b=$(this).text()?$(this).text():a;a||(a=b),null!=b&&(c.push({label:b,value:a}),d["label: "+b+", value: "+a]=$(this).attr("authority")?$(this).attr("authority"):a)}),h.data("authorities",d),b(c)})},select:function(a,c){var d=$("#"+e);d=d.length>0?d[0]:null;var f=h.data("authorities"),g=f["label: "+c.item.label+", value: "+c.item.value];if(null!=d&&(d.value=g,null!=b.confidenceName)){var i=d.form.elements[b.confidenceName];null!=i&&(i.value="accepted")}DSpaceUpdateConfidence(document,b.confidenceIndicatorID,null==g||""==g?"blank":"accepted")}}).autocomplete("widget").addClass("dropdown-menu"),$(".ui-helper-hidden-accessible").hide()})}function DSpaceChoiceLookup(a,b,c,d,e,f,g,h,i){return a+="?field="+b+"&formID="+c+"&valueInput="+d+"&authorityInput="+e+"&collection="+g+"&isName="+h+"&isRepeating="+i+"&confIndicatorID="+f+"&limit=50",$.ajax({dataType:"html",url:a,success:function(a){var b=$('<div class="modal fade">'+a+"</div>");$("body").append(b),b.modal();var c=document.getElementById("aspect_general_ChoiceLookupTransformer_div_lookup");DSpaceChoicesSetup(c),b.on("hidden.bs.modal",function(){$(this).remove()})}}),!1}function DSpaceChoicesSetup(a){var b=$("#aspect_general_ChoiceLookupTransformer_div_lookup :header:not(.page-header)");b.data("template")||b.data("template",b.html()),b.html("Loading..."),DSpaceChoicesLoad(a)}function DSpaceChoicesLoad(a){var b=$("*[name = paramField]").val(),c=$("*[name = paramValue]").val();c||(c="");var d=$("*[name = paramStart]").val(),e=$("*[name = paramLimit]").val(),f=$("*[name = paramFormID]").val(),g=$("*[name = paramCollection]").val(),h="true"==$("*[name = paramIsName]").val(),i="true"==$("*[name = paramIsRepeating]").val(),j="true"==$("*[name = paramIsClosed]").val(),k=$("*[name = contextPath]").val(),l=$("*[name = paramFail]").val(),m=$("*[name = paramValueInput]").val(),n="",o=$("*[name = paramNonAuthority]");if(o.length>0&&(n=o.val()),0==c.length){var p=$(window.document).find("#"+f);c=h?makePersonName(p.find("*[name = "+dspace_makeFieldInput(m,"_last")+"]").val(),p.find("*[name = "+dspace_makeFieldInput(m,"_first")+"]").val()):p.find("*[name = "+m+"]").val(),i&&(h?(p.find("*[name = "+dspace_makeFieldInput(m,"_last")+"]").val(""),p.find("*[name = "+dspace_makeFieldInput(m,"_first")+"]").val("")):p.find("*[name = "+m+"]").val(null)),$("*[name = paramValue]").val(c)}var q=$("select[name = chooser]:first");q.addClass("loading"),$(window).ajaxError(function(a,b,c,d){window.alert(l+" Exception="+a),null!=q&&q.removeClass("loading")}),$.ajax({url:k+"/choices/"+b,type:"GET",data:{query:c,collection:g,start:d,limit:e},error:function(){window.alert(l+" HTTP error resonse"),null!=q&&q.removeClass("loading")},success:function(a){var b=$(a).find("Choices"),d=b.attr("error");null!=d&&"true"==d&&window.alert(l+" Server indicates error in response.");var e=b.find("Choice"),f=1*b.attr("start"),g=f+e.length,i=b.attr("total"),k=b.attr("more");null==k||"false"==k?$("*[name = more]").attr("disabled","true"):$("*[name = more]").removeAttr("disabled"),$("*[name = paramStart]").val(g),null!=q&&q.removeClass("loading"),q.find("option").remove();var m=q.find("option:last"),o=-1,p=-1;$.each(e,function(a){var b=$(this);b.attr("value")==c&&(o=a),void 0!=b.attr("selected")&&(p=a);var d=$('<option value="'+b.attr("value")+'">'+b.text()+"</option>");d.data("authority",b.attr("authority")),m.length>0?m.before(d):q.append(d)}),j||q.append(new Option(dspace_formatMessage(n,c),c),null);var r=-1;if(p>=0?r=p:o>=0?r=o:1==q[0].options.length&&(r=0),r>=0){q[0].options[r].defaultSelected=!0;var s=q[0].options[r];h?($("*[name = text1]").val(lastNameOf(s.value)),$("*[name = text2]").val(firstNameOf(s.value))):$("*[name = text1]").val(s.value)}var t=0==g?0:f+1,u=$("#aspect_general_ChoiceLookupTransformer_div_lookup :header:not(.page-header)");u.html(dspace_formatMessage(u.data("template"),t,g,i,c))}})}function DSpaceChoicesSelectOnChange(){var a=$("#aspect_general_ChoiceLookupTransformer_div_lookup"),b=a.find("*[name = chooser]"),c="true"==a.find("*[name = paramIsName]").val(),d=b.val();c?(a.find("*[name = text1]").val(lastNameOf(d)),a.find("*[name = text2]").val(firstNameOf(d))):a.find("*[name = text1]").val(d)}function DSpaceChoicesAcceptOnClick(){var a=$("*[name = chooser]"),b="true"==$("*[name = paramIsName]").val(),c="true"==$("*[name = paramIsRepeating]").val(),d=$("*[name = paramValueInput]").val(),e=$("*[name = paramAuthorityInput]").val(),f=$("*[name = paramFormID]").val(),g=$("*[name = paramConfIndicatorID]").length=$("*[name = paramConfIndicatorID]").val();if(0==e.length&&(e=dspace_makeFieldInput(d,"_authority")),d.length>0){var h=$(window.document).find("#"+f);if(b?(h.find("*[name = "+dspace_makeFieldInput(d,"_last")+"]").val($("*[name = text1]").val()),h.find("*[name = "+dspace_makeFieldInput(d,"_first")+"]").val($("*[name = text2]").val())):h.find("*[name = "+d+"]").val($("*[name = text1]").val()),e.length>0&&h.find("*[name = "+e+"]").length>0){var i="",j=e.lastIndexOf("_authority_");i=0>j?e.substring(0,e.length-10)+"_confidence":e.substring(0,j)+"_confidence_"+e.substring(j+11);var k=null,l=a.find(":selected");l.length>=0&&null!=l.data("authority")&&h.find("*[name = "+e+"]").val(l.data("authority")),h.find("*[name = "+i+"]").val("accepted"),DSpaceUpdateConfidence(window.document,g,null==k||""==k?"blank":"accepted")}if(c){var m=h.find("*[name = submit_"+d+"_add]");m.length>0?m.click():alert('Sanity check: Cannot find button named "submit_'+d+'_add"')}}return!1}function DSpaceChoicesMoreOnClick(){var a=document.getElementById("aspect_general_ChoiceLookupTransformer_div_lookup");DSpaceChoicesSetup(a)}function makePersonName(a,b){return null==b||0==b.length?a:a+", "+b}function firstNameOf(a){var b=a.indexOf(",");return 0>b?"":stringTrim(a.substring(b+1))}function lastNameOf(a){var b=a.indexOf(",");return stringTrim(0>b?a:a.substring(0,b))}function stringTrim(a){for(var b=0,c=a.length;" "==a.charAt(b)&&c>b;++b);for(;c>b&&" "==a.charAt(c-1);--c);return a.slice(b,c)}function dspace_formatMessage(){var a,b=dspace_formatMessage.arguments[0];for(a=1;a<arguments.length;++a){var c="@"+a+"@";if(b.search(c)>=0){var d=dspace_formatMessage.arguments[a];void 0==d&&(d=""),b=b.replace(c,d)}}return b}function dspace_makeFieldInput(a,b){var c=a.search("_[0-9]+$");return 0>c?a+b:a.substr(0,c)+b+a.substr(c)}function DSpaceUpdateConfidence(a,b,c){if(null!=b&&""!=b){var d=a.getElementById(b);if(null!=d)if(null==d.className)d.className="cf-"+c;else{for(var e=d.className.split(" "),f="",g=!1,h=0;h<e.length;++h)e[h].match("^cf-[a-zA-Z0-9]+$")?(f+="cf-"+c+" ",g=!0):f+=e[h]+" ";g||(f+="cf-"+c+" "),d.className=f}}}function DSpaceAuthorityOnChange(a,b,c){var d="accepted";if(null!=b&&""!=b){var e=document.getElementById(b);null!=e&&(e.value=d)}return DSpaceUpdateConfidence(document,c,d),!1}function DSpaceToggleAuthorityLock(a,b){if(null==b||""==b)return!1;var c=document.getElementById(b);if(null==c)return!1;for(var d=a.className.split(" "),e="",f=!1,g=!1,h=0;h<d.length;++h)"is-locked"==d[h]?(f=!1,g=!0):"is-unlocked"==d[h]?(f=!0,g=!0):e+=d[h]+" ";return g?(a.className=e+(f?"is-locked":"is-unlocked")+" ",c.readOnly=f,!1):!1}function AuthorLookup(a,b,c){$(".authorlookup").remove();var d=$('<div class="authorlookup modal fade" tabindex="-1" role="dialog" aria-labelledby="personLookupLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title" id="personLookupLabel">Person lookup</h4></div><div class="modal-body"><div title="Person Lookup"><table class="dttable col-xs-4"><thead><th>Name</th></thead><tbody><tr><td>Loading...<td></tr></tbody></table><span class="no-vcard-selected">There\'s no one selected</span><ul class="vcard list-unstyled" style="display: none;"><li><ul class="variable"/></li><li class="vcard-insolr"><label>Items in this repository:&nbsp;</label><span/></li><li class="vcard-add"><input class="ds-button-field btn btn-default" value="Add This Person" type="button"/></li></ul></div></div></div></div></div>'),e='<button id="lookup-more-button" class="btn btn-default">show more</button>',f='<button id="lookup-less-button" class="btn btn-default">show less</button>',g=e,h=d.find("table.dttable");h.dataTable({aoColumns:[{bSortable:!1,sWidth:"200px"},{bSortable:!1,bSearchable:!1,bVisible:!1}],oLanguage:{sInfo:"Showing _START_ to _END_ of _TOTAL_ people",sInfoEmpty:"Showing 0 to 0 of 0 people",sInfoFiltered:"(filtered from _MAX_ total people)",sLengthMenu:"_MENU_ people/page",sZeroRecords:"No people found"},bAutoWidth:!1,bJQueryUI:!0,bProcessing:!0,bSort:!1,bPaginate:!1,sPaginationType:"two_button",bServerSide:!0,sAjaxSource:a,sDom:'<"H"lfr><"clearfix"t<"vcard-wrapper col-xs-8">><"F"ip>',fnInitComplete:function(){d.find("table.dttable").show(),d.find("div.vcard-wrapper").append(d.find(".no-vcard-selected")).append(d.find("ul.vcard")),d.modal(),d.find(".dataTables_wrapper").parent().attr("style","width: auto; min-height: 121px; height: auto;");var a=d.find(".dataTables_filter input"),c="";if(-1!=b.indexOf("value_"))c=$("textarea[name="+b+"]").val();else{var e=$("input[name="+b+"_last]");c=e.size()?(e.val()+" "+$("input[name="+b+"_first]").val()).trim():$("input[name="+b+"]").val()}a.val(c),setTimeout(function(){a.trigger($.Event("keyup",{keyCode:13}))},50),a.trigger($.Event("keyup",{keyCode:13})),a.addClass("form-control"),d.find(".ui-corner-tr").removeClass(".ui-corner-tr"),d.find(".ui-corner-tl").removeClass(".ui-corner-tl")},fnInfoCallback:function(a,b,c,d,e,f){return"Showing "+c+" results. "+g},fnRowCallback:function(a,c,e){c=c[1];var f=$(a),g=$(this).closest(".dataTables_wrapper").find(".vcard-wrapper .vcard").data("authorityID");return void 0!=g&&c.authority==g&&f.addClass("current-item"),f.addClass("clickable"),"false"==c.insolr&&f.addClass("notinsolr"),f.click(function(){function a(a,b,c){var d=b.replace(/-/g," "),e="";return e+='<li class="vcard-'+b+'"><label>'+d+": </label>",e+="orcid"==b?'<span><a target="_blank" href="http://orcid.org/'+a[b]+'">'+a[b]+"</a></span>":"<span>"+a[b]+"</span>",e+="</li>",c.append(e),d}var e=$(this);e.siblings(".current-item").removeClass("current-item"),e.addClass("current-item");var f=e.closest(".dataTables_wrapper").find(".vcard-wrapper");f.find(".no-vcard-selected:visible").hide();var g=f.find(".vcard");g.data("authorityID",c.authority),g.data("name",c.value);var h=["insolr","value","authority"],i=["last-name","first-name"],j=g.find(".variable");j.empty(),i.forEach(function(b){a(c,b,j)});for(var k in c)c.hasOwnProperty(k)&&h.indexOf(k)<0&&i.indexOf(k)<0&&a(c,k,j);if("false"!=c.insolr){var l=window.DSpace.context_path+"/discover?filtertype=author&filter_relational_operator=authority&filter="+c.insolr;g.find(".vcard-insolr span").empty().append('<a href="'+l+'" target="_new">view items</a>')}else g.find(".vcard-insolr span").text("0");g.find(".vcard-add input").click(function(){if(-1!=b.indexOf("value_")){$("input[name="+b+"]").val(g.find(".vcard-last-name span").text()+", "+g.find(".vcard-first-name span").text());var a=$("input[name="+b+"_authority]");a.val(g.data("authorityID")),$("textarea[name="+b+"]").val(g.data("name"))}else{var c=$("input[name="+b+"_last]");c.size()?(c.val(g.find(".vcard-last-name span").text()),$("input[name="+b+"_first]").val(g.find(".vcard-first-name span").text())):$("input[name="+b+"]").val(g.data("name")),$("input[name="+b+"_authority]").val(g.data("authorityID")),$("input[name=submit_"+b+"_add]").click()}d.modal("hide")}),g.show()}),a},fnDrawCallback:function(){var a=$(this).closest(".dataTables_wrapper");a.find(".current-item").length>0?(a.find(".vcard-wrapper .no-vcard-selected:visible").hide(),a.find(".vcard-wrapper .vcard:hidden").show()):(a.find(".vcard-wrapper .vcard:visible").hide(),a.find(".vcard-wrapper .no-vcard-selected:hidden").show()),$("#lookup-more-button").click(function(){g=f,h.fnFilter($(".dataTables_filter > input").val())}),$("#lookup-less-button").click(function(){g=e,h.fnFilter($(".dataTables_filter > input").val())})},fnServerData:function(a,b,d){var h,i,j,k;$.each(b,function(){"sEcho"==this.name?h=this.value:"sSearch"==this.name?i=this.value:"iDisplayStart"==this.name?j=this.value:"iDisplayLength"==this.name&&(k=this.value)}),void 0==c&&(c="-1"),void 0==h&&(h=""),void 0==i&&(i=""),void 0==j&&(j="0"),void 0==k&&(k="0"),g==f&&(k="20"),g==e&&(k="10");var l=[];l.push({name:"query",value:i}),l.push({name:"collection",value:c}),l.push({name:"start",value:j}),l.push({name:"limit",value:k});var m=$(this);$.ajax({cache:!1,url:a,dataType:"xml",data:l,success:function(a){var b=$(a),c=[];$.each(b.find("Choice"),function(){for(var a=this,b=[],d={},e=0;e<a.attributes.length;e++){var f=a.attributes[e];d[f.name]=f.value}b.push(d.value),b.push(d),c.push(b)});var e=b.find("Choices").attr("total"),f=m.data("totalNbPeople");(void 0==f||1>1*f)&&(f=e,m.data("totalNbPeople",f));var g={sEcho:h,iTotalRecords:f,iTotalDisplayRecords:e,aaData:c};d(g)}})}})}!function(a){DSpace.getTemplate=function(b){return(DSpace.dev_mode||void 0===DSpace.templates||void 0===DSpace.templates[b])&&a.ajax({url:DSpace.theme_path+"templates/"+b+".hbs",success:function(a){void 0===DSpace.templates&&(DSpace.templates={}),DSpace.templates[b]=Handlebars.compile(a)},async:!1}),DSpace.templates[b]}}(jQuery),function(a){function b(){return t||(t=DSpace.getTemplate("discovery_advanced_filters")),t}function c(){return u||(u=DSpace.getTemplate("discovery_simple_filters")),u}function d(){return DSpace.discovery.start_index+DSpace.discovery.filters.length}function e(a,b,c,e){"number"==typeof a?(DSpace.discovery.filters.splice(a-DSpace.discovery.start_index,0,{index:a,type:b,relational_operator:c,query:e}),i()):DSpace.discovery.filters.push({index:d(),type:b,relational_operator:c,query:e})}function f(a){return 1*/filter-new-(\d+)/.exec(a.attr("id"))[1]}function g(a){var b,c,d,e,g;b=f(a),c=a.find('select[name^="filtertype_"]').val(),d=a.find('select[name^="filter_relational_operator_"]').val(),e=a.find('input[name^="filter_"]').val(),g={index:b,type:c,relational_operator:d,query:e},h(g)}function h(a){for(var b=0;b<DSpace.discovery.filters.length;b++)if(DSpace.discovery.filters[b].index===a.index){DSpace.discovery.filters[b]=a;break}i()}function i(){for(var a=0;a<DSpace.discovery.filters.length;a++)DSpace.discovery.filters[a].index=a+DSpace.discovery.start_index}function j(a){for(var b=0;b<DSpace.discovery.filters.length;b++){var c=DSpace.discovery.filters[b];if(c.index===a){DSpace.discovery.filters.splice(b,1);break}}i()}function k(){var c,d,f;0===DSpace.discovery.filters.length&&e(null,null,null,""),c=b(),d=c({filters:DSpace.discovery.filters,i18n:DSpace.i18n.discovery}),p(),a("#new-filters-wrapper").remove(),f=a('<div id="new-filters-wrapper"/>').html(d),a("#aspect_discovery_SimpleSearch_row_filter-controls").before(f),o()}function l(){var b,d,e;DSpace.discovery.filters.length>0&&a(".active-filters-label").removeClass("hidden"),b=c(),d=b(DSpace.discovery),n(),a("#filters-overview-wrapper").remove(),e=a('<div id="filters-overview-wrapper"/>').html(d),a("#filters-overview-wrapper-squared").html("").append(e),m()}function m(){a("#filters-overview-wrapper .label").click(function(b){var c=a(this).data("index");return j(c),k(),a("#aspect_discovery_SimpleSearch_div_search-filters").submit(),!1})}function n(){a("#filters-overview-wrapper .label").off()}function o(){var b=a(".search-filter");b.find("select, input").change(function(){g(a(this).closest(".search-filter")),k()}),b.find(".filter-control.filter-add").click(function(b){var c=f(a(this).closest(".search-filter"));return e(c+1,null,null,""),k(),!1});var c=b.find(".filter-control.filter-remove");c.click(function(b){var c=f(a(this).closest(".search-filter"));return j(c),k(),!1})}function p(){var b=a(".search-filter");b.find("select, input").off(),b.find(".filter-control.filter-add").off(),b.find(".filter-control.filter-remove").off()}function q(){a(".show-advanced-filters").click(function(){var b=a("#aspect_discovery_SimpleSearch_div_discovery-filters-wrapper");return b.parent().find(".discovery-filters-wrapper-head").hide().removeClass("hidden").fadeIn(200),b.hide().removeClass("hidden").slideDown(200),a(this).addClass("hidden"),a(".hide-advanced-filters").removeClass("hidden"),!1}),a(".hide-advanced-filters").click(function(){var b=a("#aspect_discovery_SimpleSearch_div_discovery-filters-wrapper");return b.parent().find(".discovery-filters-wrapper-head").fadeOut(200,function(){a(this).addClass("hidden").removeAttr("style")}),b.slideUp(200,function(){a(this).addClass("hidden").removeAttr("style")}),a(this).addClass("hidden"),a(".show-advanced-filters").removeClass("hidden"),!1}),a("#aspect_discovery_SimpleSearch_field_submit_reset_filter").click(function(){return s(),i(),k(),!1}),a(".discovery-add-filter-button").click(function(){return e(null,null,null,""),k(),!1}),a(".controls-gear-wrapper").find("li.gear-option,li.gear-option a").click(function(b){var c,d,e,f,g,h;if(b.stopPropagation(),h=a(this),g=h.is("li")?h:h.parents("li:first"),g.hasClass("gear-option-selected"))return!1;h.attr("href")||(h=h.find("a")),f=h.attr("href").split("&"),e=a("#aspect_discovery_SimpleSearch_div_main-form");for(var i=0;i<f.length;i++)d=f[i].split("=")[0],c=f[i].split("=")[1],e.find('input[name="'+d+'"]').val(c);return e.find('input[name="page"]').val("1"),e.submit(),h.closest(".open").removeClass("open"),!1})}function r(){DSpace.discovery.orig_filters=DSpace.discovery.filters.slice(0)}function s(){DSpace.discovery.filters=DSpace.discovery.orig_filters.slice(0)}var t,u;Handlebars.registerHelper("set_selected",function(b,c){var d=a("<select />").html(c.fn(this));return d.find("[value="+b+"]").attr({selected:"selected"}),d.html()}),"undefined"!=typeof window.DSpace.discovery&&(DSpace.discovery.start_index=1,a(function(){i(),r(),q(),l(),k()}))}(jQuery),function(a){function b(){a(".row-offcanvas").hasClass("active")?a(".row-offcanvas").removeClass("active").promise().done(function(){a(".main-content").css("min-height",0).off("click",b),window.setTimeout(function(){a("#sidebar").removeAttr("style")},350)}):(a("#sidebar").show(),a(".row-offcanvas").addClass("active"),a(".main-content").css("min-height",a("#sidebar").height()),a(".main-content").on("click",b))}a(function(){a("[data-toggle=offcanvas]").on("click",b).bind("touchend",function(){a(this).mouseout()})})}(jQuery),function(a){function b(){a(".community-browser-row .toggler").click(function(){var b,g,h,i,j,k,l,m,n,o,p;m=a(this),a(".current-community-browser-row").removeClass("current-community-browser-row").find("a strong").contents().unwrap(),n=m.data("target"),h=m.parents(".sub-tree-wrapper"),i=a(".sub-tree-wrapper:not("+n+")").not(h),i.addClass("hidden"),j=a([]),i.each(function(){j=j.add(e(a(this)).closest(".community-browser-row"))}),j.removeClass("open-community-browser-row").addClass("closed-community-browser-row"),b=m.closest(".community-browser-row"),o=m.find(".open-icon"),p=m.find(".closed-icon"),k=a(".community-browser-row"),d(k),l=a(n),l.is(":visible")?(l.addClass("hidden"),o.addClass("hidden"),p.removeClass("hidden"),b.removeClass("open-community-browser-row").addClass("closed-community-browser-row"),l.find(".open-icon").addClass("hidden"),l.find(".closed-icon").removeClass("hidden"),g=e(m.closest(".sub-tree-wrapper")),g.length>0&&(g.closest(".community-browser-row").addClass("current-community-browser-row").find("a").wrapInner("<strong></strong>"),c(k,g,a(g.data("target")),g.parents(".sub-tree-wrapper")))):(l.removeClass("hidden"),o.removeClass("hidden"),p.addClass("hidden"),b.removeClass("closed-community-browser-row").addClass("open-community-browser-row").addClass("current-community-browser-row").find("a").wrapInner("<strong></strong>"),c(k,m,l,h)),f()}).bind("touchend",function(){a(this).mouseout()}),f()}function c(b,c,d,f){var g,h,i;h=b.not(c.parents(".community-browser-row")).not(d.find(".community-browser-row")),g=f.find(".community-browser-row"),i=a([]),f.each(function(){var b;b=e(a(this)),i=i.add(b.parents(".community-browser-row"))}),g=h.filter(g).not(i),h=h.not(g).not(i),0===g.length&&h.length>0&&(g=h,h=a([])),g.addClass("related-community-browser-row hidden-xs"),g.find(".open-icon").addClass("hidden"),g.find(".closed-icon").removeClass("hidden"),h.addClass("unrelated-community-browser-row hidden-xs")}function d(a){a.removeClass("related-community-browser-row hidden-xs").removeClass("unrelated-community-browser-row hidden-xs")}function e(b){return a('a[data-target="#'+b.attr("id")+'"]')}function f(){var b=a(".community-browser-row:visible");b.removeClass("odd-community-browser-row"),b=b.not(".open-community-browser-row"),b.filter(":odd").addClass("odd-community-browser-row")}a(b)}(jQuery),function(a){function b(){a(".sort-options-menu a").click(function(){var b,c;return b=a(this),c=a("#aspect_artifactbrowser_ConfigurableBrowse_div_browse-controls, #aspect_administrative_WithdrawnItems_div_browse-controls, #aspect_administrative_PrivateItems_div_browse-controls"),a('*[name="'+b.data("name")+'"]',c).val(b.data("returnvalue")),a(".btn",c).click(),b.closest(".open").removeClass("open"),!1})}function c(){a(".alphabet-select").change(function(){var b=a(this);return b.mouseout(),window.location=b.val(),!1}),a("#aspect_artifactbrowser_ConfigurableBrowse_field_year").change(function(){a("#aspect_artifactbrowser_ConfigurableBrowse_field_starts_with").val(""),a("#aspect_artifactbrowser_ConfigurableBrowse_field_submit").click()}),a("#aspect_administrative_WithdrawnItems_field_year").change(function(){a("#aspect_administrative_WithdrawnItems_field_starts_with").val(""),a("#aspect_administrative_WithdrawnItems_field_submit").click()}),a("#aspect_administrative_PrivateItems_field_year").change(function(){a("#aspect_administrative_PrivateItems_field_starts_with").val(""),a("#aspect_administrative_PrivateItems_field_submit").click()})}a(function(){c(),b()})}(jQuery),void 0!=window.runAfterJSImports&&runAfterJSImports.execute(),function(a){function b(c,d,e,f){var g,h=d.childNodes,i=document.createElement("li"),j=i;0==h.length?g="glyphicon-file":(g=f?"glyphicon-folder-open":"glyphicon-folder-close",j=a('<a href="#"></a>'),j.appendTo(i));var k=a('<span class="vocabulary-node-icon btn-xs glyphicon '+g+'"></span>');k.attr("id","node_"+d.id),k.appendTo(j);var l=document.createElement("a");if(l.setAttribute("href",d.value),l.setAttribute("class","vocabulary-label"),l.setAttribute("filter",d.value.toLowerCase()),l.innerHTML=d.label,i.appendChild(l),c.appendChild(i),0<h.length){var m=document.createElement("ul");m.setAttribute("id","node_"+d.id+"_sub"),f||m.setAttribute("style","display: none;"),a.each(h,function(a,c){b(m,c,e,!1)}),c.appendChild(m)}}function c(){a("div#aspect_submission_ControlledVocabularyTransformer_item_vocabulary-loading").hide()}function d(){a("div#aspect_submission_ControlledVocabularyTransformer_item_vocabulary-error").removeClass("hidden")}a(document).ready(function(){var e=a('a[href^="vocabulary:"]');e.click(function(e){for(var f,g,h=a(this),i=h.attr("href").replace("vocabulary:",""),j=i.substr(0,i.indexOf("/JSON/controlled-vocabulary")),k=i.slice(i.indexOf("?")+1,i.length).split("&"),l=0;l<k.length;l++){var m=k[l].split("=")[0],n=k[l].split("=")[1];"vocabularyIdentifier"==m?g=n:"metadataFieldName"==m&&(f=n)}var o="modal_vocabulary_dialog_"+g,p=a("div#"+o);return 0<p.length?p.modal("show"):a.get(j+"/controlled-vocabulary-dialog",{vocabularyIdentifier:g,metadataFieldName:f},function(e){p=a('<div class="modal fade" id="'+o+'">'+e+"</div>"),a("body").append(p),p.modal();var f=p.find("div[id^=aspect_submission_ControlledVocabularyTransformer_div_vocabulary_dialog_]");a.ajax({url:i,dataType:"json",data:{},success:function(e){null==e&&(c(),d());var g=document.createElement("ul");g.setAttribute("class","ds-simple-list vocabulary list-unstyled col-xs-12"),g.setAttribute("id","vocabulary-list"),b(g,e,j,!0),c(),f[0].appendChild(g),p.find('span[id^="node_"]').click(function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=a("ul#"+c.attr("id")+"_sub");d.is(":visible")?(d.hide(),d.find("li:first-child").hide()):(d.show(),d.find("li:first-child").show()),c.hasClass("glyphicon-folder-open")?(c.removeClass("glyphicon-folder-open"),c.addClass("glyphicon-folder-close")):c.hasClass("glyphicon-folder-close")&&(c.removeClass("glyphicon-folder-close"),c.addClass("glyphicon-folder-open"))}),a("a.vocabulary-label",p).bind("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=p.find('input[type="hidden"][name="metadataFieldName"]').val();return a('input[name="'+d+'"]').val(c.attr("href")),p.modal("hide"),!1}),a('button[name="filter_button"]',p).bind("click",function(){var b,c=a('input[name="filter"]',p).val();if(0<c.length){var d=p.find("ul#vocabulary-list");d.hide(),d.find("li").hide();var e=a('a[filter*="'+c.toLowerCase()+'"]');b=e.parents("ul,li")}else b=p.find("ul,li");return b.show(),b.find(".glyphicon-folder-close").removeClass("glyphicon-folder-close").addClass("glyphicon-folder-open"),!1})}})},"html"),!1})})}($),$(function(){function a(){$('input[name|="open_access_radios"]').length>0&&($('input[name|="open_access_radios"]').change(function(){"0"==$('input[name|="open_access_radios"]:checked').val()?c():"1"==$('input[name|="open_access_radios"]:checked').val()&&b()}),"0"==$('input[name|="open_access_radios"]:checked').val()?c():"1"==$('input[name|="open_access_radios"]:checked').val()&&b())}function b(){$("#aspect_submission_StepTransformer_field_reason").removeAttr("disabled"),$("#aspect_submission_StepTransformer_field_embargo_until_date").removeAttr("disabled")}function c(){$("#aspect_submission_StepTransformer_field_reason").attr("disabled","disabled"),$("#aspect_submission_StepTransformer_field_embargo_until_date").attr("disabled","disabled")}$(function(){a()})}),$(function(){Modernizr.inputtypes.date||$('input[type="date"]').each(function(){$(this).datepicker({dateFormat:"yy-mm-dd"})}),$("a.information").tooltip()}),function(a){Holder.invisible_error_fn=function(a){return function(b){try{a.call(this,b)}catch(c){}}}}(jQuery),$(function(){$("#aspect_statisticsGoogleAnalytics_StatisticsGoogleAnalyticsTransformer_field_startDate").datepicker({changeMonth:!0,changeYear:!0,defaultDate:"-1y",numberOfMonths:1,dateFormat:"yy-mm-dd",onClose:function(a){$("#aspect_statisticsGoogleAnalytics_StatisticsGoogleAnalyticsTransformer_field_endDate").datepicker("option","minDate",a)}}),$("#aspect_statisticsGoogleAnalytics_StatisticsGoogleAnalyticsTransformer_field_endDate").datepicker({changeMonth:!0,changeYear:!0,numberOfMonths:1,dateFormat:"yy-mm-dd",onClose:function(a){$("#aspect_statisticsGoogleAnalytics_StatisticsGoogleAnalyticsTransformer_field_startDate").datepicker("option","maxDate",a)}})}),this.DSpace=this.DSpace||{},this.DSpace.templates=this.DSpace.templates||{},this.DSpace.templates.discovery_advanced_filters=Handlebars.template({1:function(a,b,c,d,e){var f,g,h="function",i=b.helperMissing,j=this.escapeExpression,k='<div id="aspect_discovery_SimpleSearch_row_filter-new-'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'"\n     class="ds-form-item row advanced-filter-row search-filter">\n    <div class="col-xs-4 col-sm-2">\n        <p>\n            <select id="aspect_discovery_SimpleSearch_field_filtertype_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'" class="ds-select-field form-control"\n                    name="filtertype_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'">\n';return f=(b.set_selected||a&&a.set_selected||i).call(a,null!=a?a.type:a,{name:"set_selected",hash:{},fn:this.program(2,d,e),inverse:this.noop,data:d}),null!=f&&(k+=f),k+='            </select>\n        </p>\n    </div>\n    <div class="col-xs-4 col-sm-2">\n        <p>\n            <select id="aspect_discovery_SimpleSearch_field_filter_relational_operator_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'"\n                    class="ds-select-field form-control" name="filter_relational_operator_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'">\n',f=(b.set_selected||a&&a.set_selected||i).call(a,null!=a?a.relational_operator:a,{name:"set_selected",hash:{},fn:this.program(5,d,e),inverse:this.noop,data:d}),null!=f&&(k+=f),k+'            </select>\n        </p>\n    </div>\n    <div class="col-xs-4 col-sm-6">\n        <p>\n            <input id="aspect_discovery_SimpleSearch_field_filter_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'"\n                   class="ds-text-field form-control discovery-filter-input discovery-filter-input"\n                   name="filter_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'" type="text" value="'+j((g=null!=(g=b.query||(null!=a?a.query:a))?g:i,typeof g===h?g.call(a,{name:"query",hash:{},data:d}):g))+'">\n        </p>\n    </div>\n    <div class="hidden-xs col-sm-2">\n        <div class="btn-group btn-group-justified">\n                <p class="btn-group">\n                    <button id="aspect_discovery_SimpleSearch_field_add-filter_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'"\n                            class="ds-button-field btn btn-default filter-control filter-add filter-control filter-add"\n                            name="add-filter_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'" type="submit" title="Add Filter"><span\n                            class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span></button>\n                </p>\n                <p class="btn-group">\n                    <button id="aspect_discovery_SimpleSearch_field_remove-filter_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'"\n                            class="ds-button-field btn btn-default filter-control filter-remove filter-control filter-remove"\n                            name="remove-filter_'+j((g=null!=(g=b.index||(null!=a?a.index:a))?g:i,typeof g===h?g.call(a,{name:"index",hash:{},data:d}):g))+'" type="submit" title="Remove"><span\n                            class="glyphicon glyphicon-minus-sign" aria-hidden="true"></span></button>\n                </p>\n        </div>\n    </div>\n</div>\n'},2:function(a,b,c,d,e){var f,g="";return f=b.each.call(a,null!=(f=null!=e[2]?e[2].i18n:e[2])?f.filtertype:f,{name:"each",hash:{},fn:this.program(3,d,e),inverse:this.noop,data:d}),null!=f&&(g+=f),g},3:function(a,b,c,d){var e=this.lambda,f=this.escapeExpression;return'                <option value="'+f(e(d&&d.key,a))+'">'+f(e(a,a))+"</option>\n"},5:function(a,b,c,d,e){var f,g="";return f=b.each.call(a,null!=(f=null!=e[2]?e[2].i18n:e[2])?f.filter_relational_operator:f,{name:"each",hash:{},fn:this.program(3,d,e),inverse:this.noop,data:d}),null!=f&&(g+=f),g},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d,e){var f,g,h,i="function",j=b.helperMissing,k=b.blockHelperMissing,l="<!--\n\n    The contents of this file are subject to the license and copyright\n    detailed in the LICENSE and NOTICE files at the root of the source\n    tree and available online at\n\n    http://www.dspace.org/license/\n\n-->\n";
return g=null!=(g=b.filters||(null!=a?a.filters:a))?g:j,h={name:"filters",hash:{},fn:this.program(1,d,e),inverse:this.noop,data:d},f=typeof g===i?g.call(a,h):g,b.filters||(f=k.call(a,f,h)),null!=f&&(l+=f),l},useData:!0,useDepths:!0}),this.DSpace.templates.discovery_simple_filters=Handlebars.template({1:function(a,b,c,d){var e,f="function",g=b.helperMissing,h=this.escapeExpression;return'    <label href="#" class="label label-primary" data-index="'+h((e=null!=(e=b.index||(null!=a?a.index:a))?e:g,typeof e===f?e.call(a,{name:"index",hash:{},data:d}):e))+'">'+h((e=null!=(e=b.query||(null!=a?a.query:a))?e:g,typeof e===f?e.call(a,{name:"query",hash:{},data:d}):e))+"&nbsp;&times;</label>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f="<!--\n\n    The contents of this file are subject to the license and copyright\n    detailed in the LICENSE and NOTICE files at the root of the source\n    tree and available online at\n\n    http://www.dspace.org/license/\n\n-->\n";return e=b.each.call(a,null!=a?a.orig_filters:a,{name:"each",hash:{},fn:this.program(1,d),inverse:this.noop,data:d}),null!=e&&(f+=e),f},useData:!0});